/*!
* @author: Jan Wolf (https://jan-wolf.de)
* @license: 2016 Jan Wolf
*/
!function($){"use strict";var jw_lighttwitterwidget=function(options){options=$.extend({element:null,regex:{time:{unknown_variable:/(\s|^)x(\s|$)/gi,plural_indicator:/\[(.*?)]/gi,enclosing:/(minutes|hours|months|days|years)\((.*?)\)/gi},tweet:/tweet\(\)/gi,name:/name\(\)/gi,screen_name:/screen_name\(\)/gi}},options||{});var prefix=function(e){return options.element.attr("data-prefix")+"_"+e},resolve_preset=function(e,t){e=e.replace(options.regex.screen_name,t.user.screen_name),e=e.replace(options.regex.name,t.user.name);var a=!1;return e=e.replace(options.regex.time.enclosing,function(e,n,r){if(a)return"";var i=Date.now()-new Date(t.date).getTime();switch(n){case"minutes":i/=6e4;break;case"hours":i/=36e5;break;case"days":i/=864e5;break;case"months":i/=26784e5;break;case"years":i/=31536e6}return i=Math.floor(i),(a=i>=1)?(r=r.replace(options.regex.time.unknown_variable,"$1"+i+"$2"),r.replace(options.regex.time.plural_indicator,i>=2?"$1":"")):""}),e=e.replace(options.regex.tweet,t.text)},always=function(){options.element.removeClass("loading")},error=function(){options.element.addClass("error");var e=options.element.find("[data-error]");e.text(e.attr("data-error"))},no_tweets=function(){options.element.find("[data-no-tweets]").text(tweet.attr("data-no-tweets"))},ajax_obj=eval(prefix("ajaxobj"));$.ajax({url:ajax_obj.ajaxurl,cache:!1,dataType:"json",type:"POST",data:{action:prefix("twitterresponse"),nonce:ajax_obj.nonce},beforeSend:function(e){e&&e.overrideMimeType&&e.overrideMimeType("application/json;charset=UTF-8")}}).always(always).fail(error).done(function(e){switch(e.status){case"success":options.element.find("[data-preset]").each(function(){var t=resolve_preset($(this).attr("data-preset"),e.tweet),a=$(this).attr("data-preset-on");void 0===a?$(this).html(t):$(this).attr(a,t)}),options.element.find("[data-avatar]").each(function(){var t=e.tweet.user.image.replace("_normal.","_bigger.");return $(this).is("img")?void $(this).attr("src",t):void $(this).css("background-image","url("+t+")")});break;case"no-tweets":no_tweets();break;default:error()}})};$(document).ready(function(){$(".jw_lighttwitterwidget_widget").each(function(){new jw_lighttwitterwidget({element:$(this)})})})}(jQuery);